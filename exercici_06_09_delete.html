

<!DOCTYPE html>
<html class="writer-html5" lang="ca" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Exercici 06_09. Eliminació de categories i animals &mdash; Introducció a la programació amb Java 2020-21 documentació</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/moistyle.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="Quant a aquests documents" href="about.html" />
    <link rel="index" title="Índex" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Apèndix" href="apendix.html" />
    <link rel="prev" title="Exercici 06_08. Modificació d’animals" href="exercici_06_08_update.html" />
     
    <script class="googleanalytics" src="_static/moiscripts.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Introducció a la programació amb Java
          

          
            
            <img src="_static/logoprg.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2020-21
              </div>
            
          

          

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="primeres_passes.html">Primeres passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Elements bàsics de la programació</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduls.html">Mòduls</a></li>
<li class="toctree-l1"><a class="reference internal" href="fitxers.html">Fitxers</a></li>
<li class="toctree-l1"><a class="reference internal" href="poo.html">Programació Orientada a Objectes</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblioteques.html">Biblioteques</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="bd.html">Persistència amb bases de dades</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bd_modelrelacional_i_poo.html">POO i Model Relacional</a></li>
<li class="toctree-l2"><a class="reference internal" href="bd_sgbd.html">SGBD</a></li>
<li class="toctree-l2"><a class="reference internal" href="bd_jdbc.html">JDBC</a></li>
<li class="toctree-l2"><a class="reference internal" href="bd_consultes.html">El Zoo persistent</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="bd_exercicis.html">Exercicis de persistència</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="exercici_06_01_jdbc.html"> Exercici 06_01. A veure si ho he entès bé</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_06_02_drop.html"> Exercici 06_02. Elimina taula <em>CATEGORIES</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_06_03_select.html"> Exercici 06_03. Consulta de categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_06_04_id.html"> Exercici 06_04. Recuperar l’identificador</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_06_05_animals.html"> Exercici 06_05. Creació i destrucció de la taula <em>ANIMALS</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_06_06_insert.html"> Exercici 06_06. Inserció d’animals</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_06_07_select.html"> Exercici 06_07. Recuperar animals</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_06_08_update.html"> Exercici 06_08. Modificació d’animals</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"> Exercici 06_09. Eliminació de categories i animals</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apendix.html">Apèndix</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Introducció a la programació amb Java</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="bd.html">Persistència amb bases de dades</a> &raquo;</li>
        
          <li><a href="bd_exercicis.html">Exercicis de persistència</a> &raquo;</li>
        
      <li> Exercici 06_09. Eliminació de categories i animals</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    
           <div itemprop="articleBody">
            
  <div class="section" id="exerciseicon-t-exercici-06-09-eliminacio-de-categories-i-animals">
<h1><img alt="exerciseicon__T" src="_images/exerciseicon__T.png" /> Exercici 06_09. Eliminació de categories i animals<a class="headerlink" href="#exerciseicon-t-exercici-06-09-eliminacio-de-categories-i-animals" title="Link permanent a aquest títol">¶</a></h1>
<p class="rubric">Context</p>
<ul class="simple">
<li><p>Carpeta de lliurament: <code class="docutils literal notranslate"><span class="pre">06_09_delete/</span></code></p></li>
<li><p>Continguts relacionats: <a class="reference internal" href="bd_consultes.html"><span class="doc">El Zoo persistent</span></a></p></li>
<li><p>Com lliurar-lo: <a class="reference internal" href="holagit.html#instruccions-git"><span class="std std-ref">instruccions</span></a></p></li>
<li><p>[✓] Exercici amb <a class="reference internal" href="sobre_exercicis.html#descripcio-exercicis-autoavaluacio"><span class="std std-ref">autoavaluació</span></a></p></li>
</ul>
<p class="rubric">Enunciat</p>
<p>En aquest exercici implementarem els mètodes de <code class="docutils literal notranslate"><span class="pre">Zoo</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">eliminaAnimal(Animal</span> <span class="pre">animal)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">eliminaCategoria(Categoria</span> <span class="pre">categoria)</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">eliminaAnimal()</span></code> eliminarà el registre corresponent d’animal només
considerant l’identificador. Si l’animal té l’identificador indefinit, o
bé no hi ha cap registre amb aquest <code class="docutils literal notranslate"><span class="pre">id</span></code>,
no farà res.</p>
<p><code class="docutils literal notranslate"><span class="pre">eliminaCategoria()</span></code> realitzarà l’eliminació <em>en cascada</em> tot eliminant
abans els animals que puguin tenir aquesta categoria assignada. Si no hi
ha cap categoria amb l’identificador de la rebuda, o bé aquesta el té
indefinit, no farà res.</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.LinkedList</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UsaZoo</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span> <span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>
        <span class="n">Zoo</span> <span class="n">zoo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Zoo</span><span class="p">();</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Primer connectem amb la base de dades: &quot;</span><span class="p">);</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">connecta</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;connectat&quot;</span><span class="p">);</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Creem les taules&quot;</span><span class="p">);</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">creaTaulaAnimals</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Taules resultants: &quot;</span> <span class="o">+</span> <span class="n">zoo</span><span class="p">.</span><span class="na">getNomTaules</span><span class="p">());</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Intentem eliminar una categoria i un animal inexistents&quot;</span><span class="p">);</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">eliminaCategoria</span><span class="p">(</span><span class="k">new</span> <span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;mamífer&quot;</span><span class="p">));</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">eliminaAnimal</span><span class="p">(</span><span class="k">new</span> <span class="n">Animal</span><span class="p">(</span><span class="s">&quot;gat&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;mamífer&quot;</span><span class="p">)));</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>

        <span class="n">Animal</span> <span class="n">pardal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Animal</span><span class="p">(</span><span class="s">&quot;pardal&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;ocell&quot;</span><span class="p">));</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Introduïm &quot;</span> <span class="o">+</span> <span class="n">pardal</span><span class="p">);</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">afegeixAnimal</span><span class="p">(</span><span class="n">pardal</span><span class="p">);</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Eliminem l&#39;animal&quot;</span><span class="p">);</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">eliminaAnimal</span><span class="p">(</span><span class="n">pardal</span><span class="p">);</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>

        <span class="c1">// creem una llista d&#39;animals</span>
        <span class="n">Categoria</span> <span class="n">ocell</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;ocell&quot;</span><span class="p">);</span>
        <span class="n">Animal</span> <span class="n">gat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Animal</span><span class="p">(</span><span class="s">&quot;gat&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;mamífer&quot;</span><span class="p">));</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Animal</span><span class="o">&gt;</span> <span class="n">animals</span> <span class="o">=</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
            <span class="k">new</span> <span class="n">Animal</span><span class="p">(</span><span class="s">&quot;pardal&quot;</span><span class="p">,</span> <span class="n">ocell</span><span class="p">),</span>
            <span class="k">new</span> <span class="n">Animal</span><span class="p">(</span><span class="s">&quot;àliga&quot;</span><span class="p">,</span> <span class="n">ocell</span><span class="p">),</span>
            <span class="k">new</span> <span class="n">Animal</span><span class="p">(</span><span class="s">&quot;gallina&quot;</span><span class="p">,</span>  <span class="n">ocell</span><span class="p">),</span>
            <span class="n">gat</span><span class="p">,</span>
            <span class="k">new</span> <span class="n">Animal</span><span class="p">(</span><span class="s">&quot;trencalós&quot;</span><span class="p">,</span>  <span class="n">ocell</span><span class="p">)</span>
            <span class="p">);</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Afegim uns quants animals&quot;</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Animal</span> <span class="n">animal</span><span class="p">:</span> <span class="n">animals</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">zoo</span><span class="p">.</span><span class="na">afegeixAnimal</span><span class="p">(</span><span class="n">animal</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>

        <span class="n">ocell</span> <span class="o">=</span> <span class="n">zoo</span><span class="p">.</span><span class="na">obteCategoriaPerNom</span><span class="p">(</span><span class="s">&quot;ocell&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Eliminem &quot;</span> <span class="o">+</span> <span class="n">ocell</span><span class="p">);</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">eliminaCategoria</span><span class="p">(</span><span class="n">ocell</span><span class="p">);</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No deixem ni el gat!&quot;</span><span class="p">);</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">eliminaAnimal</span><span class="p">(</span><span class="n">gat</span><span class="p">);</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>

        <span class="n">Categoria</span> <span class="n">mamifer</span> <span class="o">=</span> <span class="n">zoo</span><span class="p">.</span><span class="na">obteCategoriaPerNom</span><span class="p">(</span><span class="s">&quot;mamífer&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Eliminem &quot;</span> <span class="o">+</span> <span class="n">mamifer</span><span class="p">);</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">eliminaCategoria</span><span class="p">(</span><span class="n">mamifer</span><span class="p">);</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
        <span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>


        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Finalment tanquem la connexió amb la base de dades: &quot;</span><span class="p">);</span>
        <span class="n">zoo</span><span class="p">.</span><span class="na">desconnecta</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;desconnectat&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Amb la sortida esperada:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> java UsaZoo
<span class="hll"><span class="go">Primer connectem amb la base de dades: connectat</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Creem les taules</span>
</span><span class="hll"><span class="go">Taules resultants: ANIMALS, CATEGORIES</span>
</span><span class="hll"><span class="go">Intentem eliminar una categoria i un animal inexistents</span>
</span><span class="hll"><span class="go">Cap animal</span>
</span><span class="hll"><span class="go">Cap categoria</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Introduïm Animal(id:indefinit, pardal, Categoria(id:indefinit, ocell))</span>
</span><span class="hll"><span class="go">Nombre d&#39;animals: 1</span>
</span><span class="hll"><span class="go">    Animal(id:1, pardal, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">Nombre de categories: 1</span>
</span><span class="hll"><span class="go">    Categoria(id:1, ocell)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Eliminem l&#39;animal</span>
</span><span class="hll"><span class="go">Cap animal</span>
</span><span class="hll"><span class="go">Nombre de categories: 1</span>
</span><span class="hll"><span class="go">    Categoria(id:1, ocell)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Afegim uns quants animals</span>
</span><span class="hll"><span class="go">Nombre d&#39;animals: 5</span>
</span><span class="hll"><span class="go">    Animal(id:4, gallina, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">    Animal(id:5, gat, Categoria(id:2, mamífer))</span>
</span><span class="hll"><span class="go">    Animal(id:2, pardal, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">    Animal(id:6, trencalós, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">    Animal(id:3, àliga, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">Nombre de categories: 2</span>
</span><span class="hll"><span class="go">    Categoria(id:2, mamífer)</span>
</span><span class="hll"><span class="go">    Categoria(id:1, ocell)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Eliminem Categoria(id:1, ocell)</span>
</span><span class="hll"><span class="go">Nombre d&#39;animals: 1</span>
</span><span class="hll"><span class="go">    Animal(id:5, gat, Categoria(id:2, mamífer))</span>
</span><span class="hll"><span class="go">Nombre de categories: 1</span>
</span><span class="hll"><span class="go">    Categoria(id:2, mamífer)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">No deixem ni el gat!</span>
</span><span class="hll"><span class="go">Cap animal</span>
</span><span class="hll"><span class="go">Nombre de categories: 1</span>
</span><span class="hll"><span class="go">    Categoria(id:2, mamífer)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Eliminem Categoria(id:2, mamífer)</span>
</span><span class="hll"><span class="go">Cap animal</span>
</span><span class="hll"><span class="go">Cap categoria</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Finalment tanquem la connexió amb la base de dades: desconnectat</span>
</span></pre></div>
</div>
<div class="section" id="ampliacio">
<h2>☼ Ampliació<a class="headerlink" href="#ampliacio" title="Link permanent a aquest títol">¶</a></h2>
<p>Aquests nous mètodes descobreixen un error que tenim a altres mètodes (ex.
<code class="docutils literal notranslate"><span class="pre">afegeixAnimal()</span></code> que pressuposen que si la instància respon
<code class="docutils literal notranslate"><span class="pre">false</span></code> a la crida del mètode <code class="docutils literal notranslate"><span class="pre">idIndefinit()</span></code> llavors segur que està a
la base de dades.</p>
<p>Això ja veiem que no sempre serà cert. Sense anar més lluny, si eliminem
un animal amb <code class="docutils literal notranslate"><span class="pre">eliminaAnimal()</span></code>, la instància conserva el seu <code class="docutils literal notranslate"><span class="pre">id</span></code>
original.</p>
<p>Podries pensar que és fàcil de resoldre fent que <code class="docutils literal notranslate"><span class="pre">eliminaAnimal()</span></code>
marqui la instància com a indefinida, per exemple afegint un nou mètode a
<code class="docutils literal notranslate"><span class="pre">Animal</span></code> (ex. <code class="docutils literal notranslate"><span class="pre">unsetId()</span></code>)</p>
<p>Si bé podem solucionar una mica el problema, no el resolem de ple. Com ens
ho fem per modificar totes les instàncies d’animal que pugui tenir el
nostre programa si els seus registres són eliminats de la base de dades en
eliminar la seva categoria?
Encara més, el valor del <code class="docutils literal notranslate"><span class="pre">id</span></code> el podem assignar de manera arbitrària en
crear l’animal doncs no comprova que aquest correspongui realment a una
entrada de  <em>ANIMALS</em>.
I no s’acaba aquí! Hi ha casos <em>patològics</em> com ara que un animal hagi
estat guardat i després se li canviï la categoria per una que no estigui a
la base de dades! Se t’acudeixen més vulnerabilitats?</p>
<p>En resum, que ens tocarà afegir la comprovació a tots els mètodes
implicats, de que l’identificador de cada entitat realment correspongui
amb una entrada de la taula corresponent. Fes tots els que se t’acudeixin
i et vinguin de gust.</p>
<p>Aquesta és la proposta d’ampliació. Si vols fer-la, et proposo que
afegeixis un <code class="docutils literal notranslate"><span class="pre">UsaZooAmpliat</span></code> per provar que funciona cada cas que hagis
implementat. Demana ajut si et costa pensar en les proves.</p>
</div>
</div>


           </div>
           
          </div>
    <div class="googleanalytics">
    <div id="cookiesbox">
        Aquest lloc web utilitza galetes (<i>cookies</i>) per a analitzar el seu ús
        amb les eines que ofereix <a href="https://www.google.com/analytics">Google Analytics</a>.
        En continuar navegant-hi, estàs acceptant-ho.
        <br/>
        <a class="btn btn-neutral" onclick="setUserAcceptsCookies();">
            Tancar
            <span class="fa fa-window-close"></span>
        </a>
    </div>
    <script>setCookiesboxVisibility();</script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-41103782-2', 'auto');
      ga('send', 'pageview');
    </script>
</div>


          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="apendix.html" class="btn btn-neutral float-right" title="Apèndix" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="exercici_06_08_update.html" class="btn btn-neutral float-left" title="Exercici 06_08. Modificació d’animals" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020-2021 Moisès Gómez Girón

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>